{% load cart_extras %}
<!DOCTYPE html>

<html class="" lang="en">
<head class="">
<meta charset="utf-8" class=""/>
<meta class="" content="width=device-width, initial-scale=1.0" name="viewport"/>
<title class="">Pharmastics - Products</title>

<link class="" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>

            {% if messages %}
        <div class="mb-6">
            {% for message in messages %}
            <div class="rounded-md text-white font-medium {% if message.tags == 'success' %} bg-green-500 {% elif message.tags == 'error' %} bg-red-500 {% elif message.tags == 'warning' %} bg-yellow-500 {% else %} bg-blue-500 {% endif %}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}
<script class="" src="https://cdn.tailwindcss.com"></script></head>
<body class="bg-gray-100 min-h-screen text-gray-800">
<div class="">
<div class="">
<!-- Sidebar -->
<div class="sidebar p-0">
<div class="">
<img alt="Pharmastics logo" class="" src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/120c636b-923a-456a-a13a-39844d5d3a4a.png" style="max-height: 50px;"/>
</div>
<div class="px-2">
<a class="sidebar-link" href="#">
<i class="fas fa-tachometer-alt"></i>Dashboard
                    </a>
<a class="sidebar-link active" href="#">
<i class="fas fa-shopping-bag"></i>Products
                    </a>
<a class="sidebar-link" href="#">
<i class="fas fa-prescription"></i>My Prescriptions
                    </a>
<a class="sidebar-link" href="#">
<i class="fas fa-history"></i>Order History
                    </a>
<a class="sidebar-link" href="#">
<i class="fas fa-file-medical"></i>Health Records
                    </a>
<a class="sidebar-link" href="#">
<i class="fas fa-cog"></i>Settings
                    </a>
</div>
</div>
<!-- Main Content -->
<div class="main-content">
<!-- Header -->
<div class="justify-content-between align-items-center">
<h2 class="">Pharmacy Products</h2>
<div class="dropdown">
<button class="align-items-center" data-bs-toggle="dropdown" id="dropdownMenuButton" type="button">
<img alt="User profile" class="" src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/8637fe83-4dd7-4a12-acb3-070973d2f38d.png" style="width: 32px; height: 32px;"/>
<span class="">Customer Account</span>
</button>
<ul class="dropdown-menu-end">
<li class=""><hr class="dropdown-divider"/></li>
<li class=""><a class="dropdown-item" href="{% url 'logout' %}"><i class="fas fa-sign-out-alt"></i>Logout</a></li>
</ul>
</div>
</div>
<!-- Tabs for Products/Cart/Checkout -->
<ul class="nav nav-tabs mb-0" id="myTab" role="tablist">
<li class="nav-item" role="presentation">
<button class="nav-link active" data-bs-target="#products" data-bs-toggle="tab" id="products-tab" role="tab" type="button">Products</button>
</li>
<li class="nav-item" role="presentation">
<button class="nav-link" data-bs-target="#cart" data-bs-toggle="tab" id="cart-tab" role="tab" type="button">
<i class="fas fa-shopping-cart"></i>Cart <span class="badge bg-primary rounded-pill" id="cart-count">{{ cart_products|length }}</span>
</button>
</li>
<li class="nav-item" role="presentation">
<button class="nav-link" data-bs-target="#checkout" data-bs-toggle="tab" id="checkout-tab" role="tab" type="button">Checkout</button>
</li>
</ul>
<!-- Tab Content -->
<div class="tab-content" id="myTabContent">
<!-- Products Tab -->
<div class="tab-pane fade show active" id="products" role="tabpanel">
<div class="">
<!-- <div class="col-md-6">
                                <div class="input-group mb-3">
                                    <input type="text" class="form-control" placeholder="Search products...">
                                    <button class="btn btn-primary" type="button"><i class="fas fa-search"></i></button>
                                </div>
                            </div> -->
<div class="">
<select class="" onchange="window.location.href='?cid=' + this.value">
<option class="" value="">All Categories</option>
                                        {% for c in categories %}
                                        <option %}="" %}selected{%="" class="" endif="" if="" request.get.cid|default:''="c.id|stringformat:'s'" value="{{ c.id }}" {%="">
                                            {{ c.name }}
                                        </option>
                                        {% endfor %}
                                    </select>
</div>
</div>
<div class="g-4">
<!-- Product 1 -->
                             {% for item in items %}
                            <div class="col-md-6 col-lg-4">
<div class="dashboard-card h-100">
<div class="">
                                    {% if item.item_photo %}
                                        <img alt="{{ item.item_name }}" class="product-img" src="{{ item.item_photo.url }}"/>
                                    {% else %}
                                    <i class="fas fa-pills text-blue-500 text-4xl"></i>                                    {% endif %}
                                    </div>
<h5 class="">{{ item.item_name }}</h5>
<div class="justify-content-between align-items-center">
<h5 class="mb-0">{{ item.item_price }}</h5>
</div>
<button class=""><a class="add-to-cart" href="{% url 'add_to_cart' item.id %}">
<i class="fas fa-cart-plus"></i>
</a></button>
</div>
</div>
                            {% endfor %}

                            
                       
                        </div>
</div>
<!-- Cart Tab -->
<div class="tab-pane fade" id="cart" role="tabpanel">
<div class="">
<div class="col-lg-8">
<h5 class="">Your Shopping Cart (<span class="" id="cart-items-count">0</span> items)</h5>
<div class="">
<table class="">
<thead class="">
<tr class="">
<th class="">Product</th>
<th class="">Price</th>
<th class="">Quantity</th>
<th class="">Total</th>
<th class="">Actions</th>
</tr>
</thead>
<tbody class="" id="cart-items">
<!-- Cart items will be added here dynamically -->
                                        {% if cart_products %}
                                            {% for cp in cart_products %}

                                            <tr class="">
<td class="">{{ cp.item.item_name }}</td>
<td class="">${{ cp.item.item_price }}</td>
<td class="">
<!-- Manual quantity input form -->
<form action="{% url 'update_quantity' cp.item.id %}" class="align-items-center" enctype="multipart/form-data" method="POST">
                                                        {% csrf_token %}
                                                        
                                                    <a class="btn-sm btn-outline-secondary" href="{% url 'decrease_quantity' cp.item.id %}">-</a>
                                                    {{ cp.qty }}
                                                    <a class="btn-sm btn-outline-secondary" href="{% url 'increase_quantity' cp.item.id %}">+</a>
</form>
</td>
<td class="">${{ cp.qty|multiply:cp.item.item_price }}</td>
<td class="">
<a class="btn-sm" href="{% url 'remove_from_cart' cp.item.id %}">Remove</a>
</td>
</tr>
                                             {% endfor %}   
                                            {% else %}

                                            <tr class="" id="empty-cart-message">
<td class="" colspan="5">
<i class="fas fa-shopping-cart fa-2x"></i>
<p class="">Your cart is empty</p>
<button class="" onclick="switchToProductsTab()">
<i class="fas fa-arrow-left"></i>Browse Products
                                                    </button>
</td>
</tr>
                                        {% endif %}

                                           
                                        </tbody>
</table>
</div>
</div>
<div class="col-lg-4">
<div class="dashboard-card">
<h5 class="">Order Summary</h5>
<div class="justify-content-between mb-2">
<span class="">Subtotal:</span>
<span class="" id="cart-subtotal">{{ cart.total_amount }}</span>
</div>
<div class="justify-content-between mb-2">
<span class="">Shipping:</span>
<span class="" id="cart-shipping">$5.99</span>
</div>
<div class="justify-content-between">
<span class="">Tax:</span>
<span class="" id="cart-tax">$0.00</span>
</div>
<hr class=""/>
<div class="justify-content-between">
<span class="">Total:</span>
                                            {% with total=cart.total_amount|add:"5.99" %}
                                            <span class="" id="cart-total">${{ total_amount|floatformat:2 }}</span>
                                            {% endwith %}
                                        </div>
<!-- <a href="#checkout" class="btn btn-primary w-100" data-bs-toggle="tab">Proceed to Checkout</a> -->
</div>
</div>
</div>
</div>
<!-- Checkout Tab -->
<div class="tab-pane fade" id="checkout" role="tabpanel">
<form action="{% url 'place_order' %}" class="" method="get">
<!-- {% csrf_token %} -->
<div class="">
<div class="col-lg-7">
<h5 class="">Checkout</h5>
<div class="dashboard-card">
<h6 class=""><i class="fas fa-user"></i>Contact Information</h6>
<div class="g-3">
<div class="col-md-6">
<label class="form-label"> Name</label>
<input class="" name="name" type="text" value="John"/>
</div>
<div class="col-12">
<label class="form-label">Phone</label>
<input class="" name="phone" type="tel" value="(555) 123-4567"/>
</div>
</div>
</div>
<div class="dashboard-card">
<h6 class=""><i class="fas fa-truck"></i>Shipping Address</h6>
<div class="">
<input checked="" class="" id="same-as-billing" type="checkbox"/>
<label class="" for="same-as-billing">
                                            Same as billing address
                                        </label>
</div>
<div class="g-3">
<div class="col-12">
<label class="form-label">Address</label>
<input class="" name="address" type="text" value="123 Main St"/>
</div>
</div>
</div>
<button class=""></button>
<!-- <div class="dashboard-card p-4"> 
                                    <h6 class="fw-semibold mb-3"><i class="fas fa-credit-card me-2"></i>Payment Method</h6>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="radio" name="paymentMethod" id="creditCard" checked>
                                        <label class="form-check-label" for="creditCard">
                                            Credit Card
                                        </label>
                                    </div>
                                    <div class="row g-3">
                                        <div class="col-12">
                                            <label class="form-label">Card Number</label>
                                            <input type="text" class="form-control" placeholder="1234 5678 9012 3456">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Expiration Date</label>
                                            <input type="text" class="form-control" placeholder="MM/YY">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Security Code</label>
                                            <input type="text" class="form-control" placeholder="CVC">
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label">Name on Card</label>
                                            <input type="text" class="form-control" placeholder="John Doe">
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="savePayment" checked>
                                        <label class="form-check-label" for="savePayment">
                                            Save payment information for next time
                                        </label>
                                    </div>
                                </div>  -->
</div>
<div class="col-lg-5">
<div class="dashboard-card" style="top: 20px;">
<h5 class="">Order Summary</h5>
                                    {% for cp in cart_products %}
                                    <div class="" id="checkout-items">
<!-- Order items will be added here dynamically -->
<span class="">{{ cp.item.item_name }} × {{ cp.qty }}</span>
<span class="">${{ cp.qty|multiply:cp.item.item_price }}</span>
</div>
                                    {% endfor %}
                                    <hr class=""/>
<div class="justify-content-between mb-2">
<span class="">Subtotal:</span>
<span class="" id="checkout-subtotal">{{ cart.total_amount }}</span>
</div>
<div class="justify-content-between mb-2">
<span class="">Shipping:</span>
<span class="" id="checkout-shipping">$5.99</span>
</div>
<div class="justify-content-between">
<span class="">Tax:</span>
<span class="" id="checkout-tax">$0.00</span>
</div>
<hr class=""/>
<div class="justify-content-between">
<span class="">Total:</span>
                                            {% with total=cart.total_amount|add:"5.99" %}
                                            <span class="" id="cart-total">${{ total_amount|floatformat:2 }}</span>
                                            {% endwith %}
                                        </div>
<button class="w-100" type="submit">
<i class="fas fa-lock"></i>Place Order
                                    </button>
</div>
</div>
</div>
</form>
</div>
</div>
</div>
</div>
</div>
<!-- Mobile Footer Navigation -->
<nav class="mobile-footer-nav">
<div class="nav-item">
<a class="nav-link" href="#">
<i class="fas fa-tachometer-alt"></i>
<span class="">Dashboard</span>
</a>
</div>
<div class="nav-item">
<a class="nav-link active" href="#">
<i class="fas fa-shopping-bag"></i>
<span class="">Products</span>
</a>
</div>
<div class="nav-item">
<a class="nav-link" href="#">
<i class="fas fa-prescription"></i>
<span class="">Prescriptions</span>
</a>
</div>
<div class="nav-item">
<a class="nav-link" href="#">
<i class="fas fa-cog"></i>
<span class="">Settings</span>
</a>
</div>
</nav>
<script class="" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>