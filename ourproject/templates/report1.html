<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Reports | Pharmacy Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- from node_modules -->
<script src="node_modules/@material-tailwind/html/scripts/tabs.js"></script>
 
<!-- from cdn -->
<script src="https://unpkg.com/@material-tailwind/html@latest/scripts/tabs.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                        secondary: '#3b82f6',
                        lightblue: '#dbeafe',
                        darkblue: '#1e3a8a'
                    }
                }
            }
        }
    </script>
    <style>
        @media (max-width: 640px) {
            .responsive-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
            .mobile-card {
                min-width: 300px;
            }
        }
        @media (max-width: 768px) {
            .grid-cols-1-md {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }
        }
        .card {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .status-badge {
            transition: all 0.2s ease;
        }
        .datepicker-input {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%233b82f6' viewBox='0 0 16 16'%3E%3Cpath d='M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 16px 12px;
        }
    </style>
</head>

<body class="bg-gray-50 flex flex-col min-h-screen">



    <!-- Navigation -->
    <nav class="bg-primary text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <i class="fas fa-clinic-medical text-2xl"></i>
                    </div>
                    <div class="hidden md:block">
                        <div class="ml-10 flex items-baseline space-x-4">
                            <a href="pharmastic dashboard.html" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-secondary">Dashboard</a>
                            <a href="{% url 'order_view' %}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-secondary">Orders</a>
                            <a href="{% url 'inventory_view' %}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-secondary">Inventory</a>
                            <a href="{% url 'report_view' %}" class="px-3 py-2 rounded-md text-sm font-medium bg-white text-primary">Reports</a>
                            <a href="{% url 'purchaseorder_view' %}" class="px-3 py-2 rounded-md text-sm font-medium bg-white text-primary">Purchase Order</a>

                        </div>
                    </div>
                </div>
                <div class="flex items-center">
                    <button class="p-1 rounded-full text-white focus:outline-none">
                        <i class="fas fa-bell"></i>
                    </button>
                    <div class="ml-3 relative">
                        <div class="flex items-center">
                            <div class="text-sm mr-3 hidden md:block">Dr. Sarah Miller</div>
                            <div class="relative group">
                                <img class="h-8 w-8 rounded-full object-cover cursor-pointer" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 24 24'%3E%3Cpath fill='%23ffffff' d='M12 12q-1.65 0-2.825-1.175T8 8q0-1.65 1.175-2.825T12 4q1.65 0 2.825 1.175T16 8q0 1.65-1.175 2.825T12 12Zm-8 8v-2.8q0-.85.438-1.563T5.6 14.55q1.55-.775 3.15-1.163T12 13q1.65 0 3.25.388t3.15 1.162q.725.375 1.163 1.088T20 17.2V20H4Z'/%3E%3C/svg%3E" alt="User">
                                <!-- Dropdown menu -->
                                <div class="hidden group-hover:block absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10">
                                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Profile</a>
                                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Settings</a>
                                    <a href="#" id="logout-button" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100">Logout</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 flex-grow">
        <!-- Report Header -->
        <div class="mb-8 flex flex-col md:flex-row justify-between items-start md:items-center">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">Sales Reports</h1>
                <p class="mt-2 text-gray-600">Analyze and track your pharmacy sales performance</p>
            </div>
            <div class="mt-4 md:mt-0">
                <button id="export-report" class="px-4 py-2 border border-primary text-primary rounded-md hover:bg-lightblue transition flex items-center">
                    <i class="fas fa-file-export mr-2"></i> Export Report
                </button>
            </div>
        </div>

        <!-- Report Filters -->
        <div class="card bg-white rounded-lg mb-8">
            <div class="p-6">
                <h2 class="text-lg font-medium text-gray-900 mb-4">Filter Reports</h2>
                <form class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label for="report-type" class="block text-sm font-medium text-gray-700 mb-1">Report Type</label>
                        <select id="report-type" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary">
                            <option>Sales Summary</option>
                            <option>Product Performance</option>
                            <option>Payment Methods</option>
                            <option>Hourly Sales</option>
                            <option>Staff Performance</option>
                        </select>
                    </div>
                    <div>
                        <label for="date-range" class="block text-sm font-medium text-gray-700 mb-1">Date Range</label>
                        <select id="date-range" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary">
                            <option>Today</option>
                            <option>Yesterday</option>
                            <option>This Week</option>
                            <option>Last Week</option>
                            <option>This Month</option>
                            <option>Last Month</option>
                            <option>Custom Range</option>
                        </select>
                    </div>
                    <div>
                        <label for="start-date" class="block text-sm font-medium text-gray-700 mb-1">Start Date</label>
                        <input type="date" id="start-date" class="datepicker-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary">
                    </div>
                    <div>
                        <label for="end-date" class="block text-sm font-medium text-gray-700 mb-1">End Date</label>
                        <input type="date" id="end-date" class="datepicker-input w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary">
                    </div>
                    <div class="md:col-span-4 flex justify-end space-x-3">
                        <button type="reset" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">Reset</button>
                        <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-primary hover:bg-darkblue">Generate Report</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- MODAL TRIGGERS (Place inside the summary card loop or near header if preferred) -->
<div class="flex gap-4 mb-6">
  <button onclick="openModal('sales-report-modal')" class="bg-primary text-white px-4 py-2 rounded shadow">Sales Report</button>
  <button onclick="openModal('pos-report-modal')" class="bg-green-600 text-white px-4 py-2 rounded shadow">POS Report</button>
  <button onclick="openModal('online-report-modal')" class="bg-blue-600 text-white px-4 py-2 rounded shadow">Online Report</button>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    {% for summary in summary_list %}
    <div class="card bg-white rounded-lg p-6">
        <div class="flex items-center">
            <div class="rounded-full {{ summary.bg }} p-3 mr-4">
                <i class="fas {{ summary.icon }} {{ summary.text }} text-xl"></i>
            </div>
            <div>
                <p class="text-gray-500">{{ summary.label }}</p>
                <p class="text-2xl font-bold">
                    {{ summary.value }}{% if summary.unit %} {{ summary.unit }}{% endif %}
                </p>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- Sales Trend Chart -->
            <div class="card bg-white rounded-lg">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-lg font-medium text-gray-900">Sales Trend (Last 30 Days)</h2>
                        <div class="flex space-x-2">
                            <button class="text-xs px-2 py-1 bg-lightblue text-primary rounded">Daily</button>
                            <button class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200">Weekly</button>
                            <button class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200">Monthly</button>
                        </div>
                    </div>
                    <div class="h-80">
                        <canvas id="salesTrendChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Payment Methods Chart -->
            <div class="card bg-white rounded-lg">
                <div class="p-6">
                    <h2 class="text-lg font-medium text-gray-900 mb-4">Payment Methods</h2>
                    <div class="h-80">
                        <canvas id="paymentMethodsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>


<!-- Top Selling Products -->
<!-- Top Selling Products -->
<div class="card bg-white rounded-lg mb-8">
    <div class="p-6">
        <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-medium text-gray-900">Top Selling Products</h2>
            <a href="#" class="text-sm text-blue-600 hover:text-blue-900">View All</a>
        </div>
        <div class="responsive-table">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Product</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Qty Sold</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Revenue</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Margin</th>
                    </tr>
                </thead>
<tbody class="bg-white divide-y divide-gray-200">
    {% for product in top_products %}
        <tr>
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                {{ product.item__item_name }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                {{ product.item__category__name|default:"-" }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                {{ product.total_qty }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                {{ product.total_revenue }} Ks
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                {% if product.margin != "-" %}
                    {{ product.margin }}%
                {% else %}
                    -
                {% endif %}
            </td>
        </tr>
            {% empty %}
        <tr><td colspan="5" class="text-center py-4 text-sm text-gray-500">No top products yet.</td></tr>
    {% endfor %}
</tbody>            </table>
        </div>
    </div>
</div>

<div class="w-full">
  <div class="relative right-0">
    <ul class="relative flex flex-wrap px-1.5 py-1.5 list-none rounded-md bg-slate-100" data-tabs="tabs" role="list">
      <li class="z-30 flex-auto text-center">
        <a class="z-30 flex items-center justify-center w-full px-0 py-2 text-sm mb-0 transition-all ease-in-out border-0 rounded-md cursor-pointer text-slate-600 bg-inherit"
        data-tab-target="" role="tab" aria-selected="true" aria-controls="dashboard">
          Dashboard
        </a>
      </li>
      <li class="z-30 flex-auto text-center">
        <a class="z-30 flex items-center justify-center w-full px-0 py-2 mb-0 text-sm transition-all ease-in-out border-0 rounded-lg cursor-pointer text-slate-600 bg-inherit"
        data-tab-target="" role="tab" aria-selected="false"  aria-controls="profile">
          Profile
        </a>
      </li>
      <li class="z-30 flex-auto text-center">
        <a class="z-30 flex items-center justify-center w-full px-0 py-2 text-sm mb-0 transition-all ease-in-out border-0 rounded-lg cursor-pointer text-slate-700 bg-inherit"
        data-tab-target="" role="tab" aria-selected="false" aria-controls="settings">
          Settings
        </a>
      </li>
    </ul>
 
    <div data-tab-content="" class="p-5">
      <div id="dashboard" role="tabpanel">
        <p class="text-slate-400 font-light">
          Because it&apos;s about motivating the doers. Because I&apos;m
          here to follow my dreams and inspire other people to follow their
          dreams, too.
        </p>
      </div>
      <div class="hidden opacity-0" id="profile" role="tabpanel">
        <p class="text-slate-400 font-light">
          The reading of all good books is like a conversation with the
          finest minds of past centuries.
        </p>
      </div>
      <div class="hidden opacity-0" id="settings" role="tabpanel">
        <p class="text-slate-400 font-light">
          Comparing yourself to others is the thief of joy.
        </p>
      </div>
    </div>
  </div>
</div>

<!-- POS + Online Summary -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
    <div class="card bg-white rounded-lg p-6">
        <h2 class="text-lg font-medium text-gray-900 mb-4">POS Transactions</h2>
        <ul class="space-y-2 text-sm text-gray-700">
            <li><strong>POS Transactions:</strong> {{ pos_transactions }}</li>
            <li><strong>POS Revenue:</strong> {{ pos_revenue }} Ks</li>
        </ul>
    </div>
    <div class="card bg-white rounded-lg p-6">
        <h2 class="text-lg font-medium text-gray-900 mb-4">Online Summary</h2>
        <ul class="space-y-2 text-sm text-gray-700">
            <li><strong>Online Transactions:</strong> {{ online_transactions }}</li>
            <li><strong>Online Revenue:</strong> {{ online_revenue }} Ks</li>
        </ul>
    </div>
</div>

    </div>

    


    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-lg font-medium mb-4">Pharmacy Pro</h3>
                    <p class="text-gray-400">Comprehensive pharmacy management solution for modern healthcare providers.</p>
                </div>
                <div>
                    <h3 class="text-lg font-medium mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="pharmastic dashboard.html" class="text-gray-400 hover:text-white">Dashboard</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Orders</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Inventory</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Reports</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-medium mb-4">Contact Us</h3>
                    <ul class="space-y-2">
                        <li class="flex items-center text-gray-400"><i class="fas fa-map-marker-alt mr-2"></i> 123 Medical St, Health City</li>
                        <li class="flex items-center text-gray-400"><i class="fas fa-phone-alt mr-2"></i> (555) 123-4567</li>
                        <li class="flex items-center text-gray-400"><i class="fas fa-envelope mr-2"></i> support@pharmacypro.com</li>
                    </ul>
                </div>
            </div>


            <div class="border-t border-gray-700 mt-8 pt-8 flex flex-col md:flex-row justify-between items-center">
                <p class="text-gray-400 text-sm">Â© 2023 Pharmacy Pro. All rights reserved.</p>
                <div class="flex space-x-6 mt-4 md:mt-0">
                    <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-linkedin-in"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Mobile Bottom Navigation -->
    <div class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200">
        <div class="flex justify-around">
            <a href="pharmastic dashboard.html" class="p-4 text-gray-500">
                <i class="fas fa-home block text-center text-xl"></i>
                <span class="text-xs block text-center mt-1">Home</span>
            </a>
            <a href="#" class="p-4 text-gray-500">
                <i class="fas fa-cash-register block text-center text-xl"></i>
                <span class="text-xs block text-center mt-1">Orders</span>
            </a>
            <a href="#" class="p-4 text-gray-500">
                <i class="fas fa-boxes block text-center text-xl"></i>
                <span class="text-xs block text-center mt-1">Stock</span>
            </a>
            <a href="#" class="p-4 text-primary">
                <i class="fas fa-chart-bar block text-center text-xl"></i>
                <span class="text-xs block text-center mt-1">Reports</span>
            </a>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div id="logout-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 max-w-sm w-full">
            <h3 class="text-lg font-medium text-gray-900 mb-4">Confirm Logout</h3>
            <p class="text-gray-600 mb-6">Are you sure you want to log out of your account?</p>
            <div class="flex justify-end space-x-3">
                <button id="cancel-logout" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">Cancel</button>
                <button id="confirm-logout" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700">Logout</button>
            </div>
        </div>
    </div>

    <script>
        // Logout functionality
        document.getElementById('logout-button').addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('logout-modal').classList.remove('hidden');
        });

        document.getElementById('cancel-logout').addEventListener('click', function() {
            document.getElementById('logout-modal').classList.add('hidden');
        });

        document.getElementById('confirm-logout').addEventListener('click', function() {
            alert('You have been logged out successfully.');
            document.getElementById('logout-modal').classList.add('hidden');
        });

        // Export report
        document.getElementById('export-report').addEventListener('click', function() {
            alert('Report exported successfully. You can download it from your downloads folder.');
        });

        // Initialize charts
        document.addEventListener('DOMContentLoaded', function() {
            // Sales Trend Chart
            const salesTrendCtx = document.getElementById('salesTrendChart').getContext('2d');
            const salesTrendChart = new Chart(salesTrendCtx, {
                type: 'line',
                data: {
                    labels: ['Jan 1', 'Jan 2', 'Jan 3', 'Jan 4', 'Jan 5', 'Jan 6', 'Jan 7', 'Jan 8', 'Jan 9', 'Jan 10', 'Jan 11', 'Jan 12', 'Jan 13', 'Jan 14', 'Jan 15', 'Jan 16', 'Jan 17', 'Jan 18', 'Jan 19', 'Jan 20', 'Jan 21', 'Jan 22', 'Jan 23', 'Jan 24', 'Jan 25', 'Jan 26', 'Jan 27', 'Jan 28', 'Jan 29', 'Jan 30'],
                    datasets: [{
                        label: 'Daily Sales ($)',
                        data: [420, 380, 450, 510, 490, 520, 550, 510, 480, 520, 540, 580, 600, 620, 590, 610, 630, 650, 670, 690, 710, 730, 750, 770, 790, 810, 830, 850, 870, 890],
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderColor: '#3b82f6',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                drawBorder: false
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // Payment Methods Chart
            const paymentMethodsCtx = document.getElementById('paymentMethodsChart').getContext('2d');
            const paymentMethodsChart = new Chart(paymentMethodsCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Credit Card', 'Cash', 'Mobile Payment', 'Insurance'],
                    datasets: [{
                        data: [45, 30, 15, 10],
                        backgroundColor: [
                            '#10b981',
                            '#3b82f6',
                            '#8b5cf6',
                            '#6b7280'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        });
    </script>
</body>
</html>